# CICD-SEC-10: Недостаточное журналирование и прозрачность
## Определение
Недостаточный уровень регистрации и видимости рисков позволяет противнику осуществлять вредоносные действия в среде CI/CD, оставаясь незамеченным на любом этапе цепочки поражения атаки, включая выявление TTP (Techniques, Tactics and Procedures) злоумышленника в рамках любого расследования после инцидента.

## Описание
Наличие мощных средств протоколирования и визуализации является необходимым условием для подготовки, обнаружения и расследования инцидентов, связанных с безопасностью.

Если рабочие станции, серверы, сетевые устройства и ключевые ИТ- и бизнес-приложения обычно подробно рассматриваются в рамках программ регистрации и контроля, то с системами и процессами в инженерных средах дело обстоит иначе.

Учитывая количество потенциальных векторов атак, использующих инженерные среды и процессы, крайне важно, чтобы службы безопасности создавали соответствующие возможности для обнаружения этих атак сразу после их возникновения. Поскольку многие из этих векторов связаны с использованием программного доступа к различным системам, ключевым аспектом решения этой задачи является создание высокого уровня видимости как человеческого, так и программного доступа.

Учитывая сложную природу векторов CI/CD-атак, одинаково важны как журналы аудита систем - например, доступ пользователей, создание пользователей, изменение прав, так и журналы прикладных атак - например, событие push в репозиторий, выполнение сборок, загрузка артефактов.

## Воздействие
Поскольку противники постепенно переключают свое внимание на инженерные среды как средство достижения своих целей, организации, не обеспечивающие надлежащий контроль ведения журналов и видимости этих сред, могут не обнаружить брешь и столкнуться с большими трудностями при устранении последствий из-за минимальных возможностей расследования.

Время и данные являются наиболее ценными товарами для организации, подвергающейся атаке. Наличие всех необходимых источников данных в централизованном хранилище может стать разницей между успешным и катастрофическим исходом в сценарии реагирования на инцидент.

## Рекомендации
Для достижения достаточного уровня протоколирования и видимости существует несколько элементов:

- [ ] Составление карты среды - сильная видимость не может быть достигнута без глубокого знакомства со всеми различными системами, вовлеченными в потенциальные угрозы. Потенциальная угроза может быть связана с любой из систем, участвующих в процессах CI/CD, включая SCM, CI, репозитории артефактов, программное обеспечение для управления пакетами, реестры контейнеров, CD и механизмы оркестровки (например, K8s).
- [ ] Определение и создание реестра всех систем, используемых в организации, с указанием каждого экземпляра этих систем (особенно актуально для самоуправляемых систем, например Jenkins).
- [ ] Определение и включение соответствующих источников журналов - после определения всех соответствующих систем следующим шагом является обеспечение включения всех соответствующих журналов, поскольку в различных системах это не является состоянием по умолчанию. Видимость должна быть оптимизирована как для доступа людей, так и для программного доступа с помощью различных разрешенных мер. Важно уделять одинаковое внимание как определению всех релевантных источников журналов аудита, так и источников журналов прикладного характера.
- [ ] Отправка журналов в централизованное место (например, SIEM) для поддержки агрегации и корреляции журналов между различными системами с целью обнаружения и расследования.
- [ ] Создание оповещений для обнаружения аномалий и потенциальной вредоносной активности как в каждой системе в отдельности, так и аномалий в процессе доставки кода, который включает в себя множество систем и требует более глубоких знаний в области внутренних процессов сборки и развертывания.

## Ссылки
Возможности протоколирования и визуализации очень важны и актуальны для обнаружения и расследования любого инцидента, независимо от того, какой риск был использован при его возникновении. Любой инцидент безопасности последних лет, связанный с CI/CD-системами, требует от организации-жертвы сильной видимости, чтобы иметь возможность правильно провести расследование и понять масштабы ущерба от атаки.